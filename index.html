<!DOCTYPE html>
<html lang = "zh-CN">
<head>
<meta charset = "UTF-8">

<script type="text/javascript">
function timeCountdown(){
    var timeNode = new Array();
    timeNode[0] = [ 0, 1]; // 00:01 NightMoon starts (monthly, first Sunday)
    timeNode[1] = [23,59]; // 23:59 NightMoon ends (monthly, the Saturday after first Sunday)
    timeNode[2] = [ 3, 0]; // daily quest (daily)
    timeNode[3] = [ 7, 0]; // weekly events starts (weekly, Thursday)
                           // raid CD; Mythic(+) CD/box (weekly, Thursday)
                           // world quest 1; Azrite, opposite (daily)
                           // 5H (daily)
    timeNode[4] = [15, 0]; // world quest 2 (daily)
    timeNode[5] = [19, 0]; // world quest 3; opposite (daily)
    timeNode[6] = [23, 0]; // world quest 4 (daily)
    timeNode[7] = [ 4, 0]; // weekly events ends (weekly, Thursday)

    var loadTime = new Date(); // get current time (full information)
    var cur = {
        // cur is short for 'current (time)', actually same as 'Date'
        // toNextHour -- time to next hour (in seconds)
        date: loadTime.getDate(), // 1~31
        day: loadTime.getDay(), // 0~6 Sun~Sat
        hours: loadTime.getHours(), // 0~23
        min: loadTime.getMinutes(), // 0~59
        Seconds: loadTime.getSeconds(), // 0~59
        toNextHour:function(){
            m = loadTime.getMinutes();
            s = loadTime.getSeconds();
            return 3600 - m * 60 - s;
        }
    }

    var timeOutput = {
    // return a string -- (days) hrs:mins:secs
        dailyQuest: function(){
            var h = (timeNode[2][0] + 23 - cur.hours) % 24;
            var s = cur.toNextHour() % 60;
            var m = (cur.toNextHour() - s) / 60;
            if (m == 60)
                {h+=1;m=0;}
            [h,m,s]=checkTime([h,m,s]);

            return h+":"+m+":"+s;
        },
        worldQuest: function(){
            if (cur.hours >= timeNode[3][0] && cur.hours < timeNode[4][0])
                {var h = timeNode[4][0] - cur.hours - 1;}
            else if (cur.hours >= timeNode[4][0] && cur.hours < timeNode[5][0])
                {var h = timeNode[5][0] - cur.hours - 1;}
            else if (cur.hours >= timeNode[5][0] && cur.hours < timeNode[6][0])
                {var h = timeNode[6][0] - cur.hours - 1;}
            else
                {var h = (timeNode[3][0] + 23 - cur.hours) % 24;}

            var s = cur.toNextHour() % 60;
            var m = (cur.toNextHour() - s) / 60;
            if (m == 60)
                {h+=1;m=0;}
            [h,m,s]=checkTime([h,m,s]);

            return h+":"+m+":"+s;
        }
    }

    document.getElementById("world-Quest").innerHTML="下一次世界任务 "+timeOutput.worldQuest();
    document.getElementById("daily-Quest").innerHTML="下一次日常刷新 "+timeOutput.dailyQuest();
    t=setTimeout('timeCountdown()',500) // 无需"t="也可运行
};

function checkTime(arr){
// add front 0 for numbers less than 10
    for (var i=0; i<arr.length; i++){
        if (arr[i] < 10) 
            {arr[i] = "0" + arr[i];}
    }
    return arr;
};

</script>
</head>

<body onload="timeCountdown()">
<h1>今日赞达拉 v0.0.0</h1>
<div id="world-Quest"></div>
<div id="daily-Quest"></div>
</body>

</html>
